<div class="user-dialog">
  <h2 mat-dialog-title class="dialog-title">
    <mat-icon class="title-icon">{{ isEdit ? 'edit' : 'add_circle' }}</mat-icon>
    {{ dialogTitle }}
  </h2>

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <mat-dialog-content class="dialog-content">
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>姓</mat-label>
          <input 
            matInput 
            formControlName="lastName" 
            placeholder="姓を入力してください"
            [class.is-invalid]="isFieldInvalid('lastName')">
          <mat-error *ngIf="isFieldInvalid('lastName')">
            {{ getErrorMessage('lastName') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>名</mat-label>
          <input 
            matInput 
            formControlName="firstName" 
            placeholder="名を入力してください"
            [class.is-invalid]="isFieldInvalid('firstName')">
          <mat-error *ngIf="isFieldInvalid('firstName')">
            {{ getErrorMessage('firstName') }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>メールアドレス</mat-label>
          <input 
            matInput 
            type="email" 
            formControlName="email" 
            placeholder="メールアドレスを入力してください"
            [class.is-invalid]="isFieldInvalid('email')">
          <mat-error *ngIf="isFieldInvalid('email')">
            {{ getErrorMessage('email') }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field full-width">
          <mat-label>JSONデータ</mat-label>
          <textarea 
            matInput 
            formControlName="jsonData" 
            rows="4"
            placeholder='{"age": 25, "city": "東京", "hobbies": ["読書", "旅行"]}'
            [class.is-invalid]="isFieldInvalid('jsonData')"></textarea>
          <mat-hint>有効なJSON形式で入力してください</mat-hint>
          <mat-error *ngIf="isFieldInvalid('jsonData')">
            {{ getErrorMessage('jsonData') }}
          </mat-error>
        </mat-form-field>
      </div>
    </mat-dialog-content>

    <mat-dialog-actions align="end" class="dialog-actions">
      <button 
        mat-button 
        type="button" 
        (click)="onCancel()" 
        class="cancel-button">
        <mat-icon>cancel</mat-icon>
        キャンセル
      </button>
      <button 
        mat-raised-button 
        color="primary" 
        type="submit" 
        [disabled]="userForm.invalid"
        class="submit-button">
        <mat-icon>{{ isEdit ? 'save' : 'add_circle' }}</mat-icon>
        {{ isEdit ? '更新' : '追加' }}
      </button>
    </mat-dialog-actions>
  </form>
</div>
